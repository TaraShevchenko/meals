# Режим заказа

## Описание

Функциональность "Режим заказа" позволяет выбирать диапазон дат и автоматически рассчитывать необходимые ингредиенты для всех меню в этом периоде.

## Возможности

### Основные функции

- **Выбор диапазона дат** - указание начальной и конечной даты для расчета
- **Автоматический расчет ингредиентов** - система агрегирует все ингредиенты из меню в выбранном диапазоне
- **Сохранение истории** - все сгенерированные отчеты сохраняются в базе данных
- **Экспорт в CSV** - возможность скачать отчет в формате CSV

### Структура данных

- **Количество** - суммарное количество каждого ингредиента
- **Наименование** - название ингредиента
- **Путь** - категория компонента и тип приема пищи (например: "PROTEIN/BREAKFAST")
- **Питательная ценность** - калории, белки, углеводы, жиры

## Технические детали

### Модели базы данных

- `OrderReport` - основная модель отчета с названием и диапазоном дат
- `OrderReportItem` - элементы отчета с ингредиентами и количествами

### API Endpoints

- `POST /api/order-report` - создание нового отчета
- `GET /api/order-report` - получение списка всех отчетов
- `GET /api/orderReports` - API для React Admin
- `GET /api/orderReports/[id]` - получение конкретного отчета

### Интерфейс

- **Страница пользователя**: `/order-mode` - основной интерфейс для создания и просмотра отчетов
- **Админка**: доступ через React Admin для управления отчетами

## Использование

1. Перейдите на страницу `/order-mode`
2. Введите название отчета
3. Выберите диапазон дат
4. Нажмите "Создать отчет"
5. Просмотрите результаты в таблице
6. При необходимости экспортируйте данные в CSV

## Алгоритм расчета

1. Система находит все меню в указанном диапазоне дат
2. Для каждого меню извлекаются все блюда
3. Для каждого блюда извлекаются все компоненты
4. Для каждого компонента извлекаются все ингредиенты
5. Ингредиенты группируются по ID и суммируются количества
6. Формируется путь в формате `{тип_компонента}/{тип_приема_пищи}`
